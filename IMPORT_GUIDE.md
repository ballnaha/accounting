# คู่มือการนำเข้าข้อมูลบุคลากรตำรวจ

## ภาพรวม
ระบบรองรับการนำเข้าข้อมูลจำนวนมากผ่านไฟล์ Excel (.xlsx, .xls) เพื่อความสะดวกและรวดเร็ว

## ขั้นตอนการนำเข้าข้อมูล

### 1. ดาวน์โหลด Template
1. เข้าหน้านำเข้าข้อมูล (`/personnel/import`)
2. คลิกปุ่ม "ดาวน์โหลด Template"
3. เปิดไฟล์ template ด้วย Microsoft Excel หรือ Google Sheets

### 2. เตรียมข้อมูล
กรอกข้อมูลในไฟล์ Excel ตามคอลัมน์ที่กำหนด:

#### คอลัมน์ที่จำเป็น (บังคับ)
- **ชื่อ** - ชื่อจริง
- **สกุล** - นามสกุล
- **ID** - รหัสประจำตัวเจ้าหน้าที่ (ต้องไม่ซ้ำ)

#### คอลัมน์เสริม (ไม่บังคับ)
- **อาวุโส** - ตัวเลขลำดับอาวุโส
- **ยศ** - ยศตำรวจ (เช่น พ.ต.อ., ร.ต.ต., ด.ต.)
- **POSCODE** - รหัสตำแหน่ง
- **ตำแหน่ง** - ชื่อตำแหน่งงาน
- **เลขตำแหน่ง** - เลขที่ตำแหน่ง
- **ทำหน้าที่** - หน้าที่รับผิดชอบ
- **แต่งตั้งครั้งสุดท้าย** - วันที่แต่งตั้ง (dd/mm/yyyy)
- **ระดับนี้เมื่อ** - วันที่ดำรงยศปัจจุบัน (dd/mm/yyyy)
- **บรรจุ** - วันที่บรรจุเข้ารับราชการ (dd/mm/yyyy)
- **วันเกิด** - วันเดือนปีเกิด (dd/mm/yyyy)
- **คุณวุฒิ** - ระดับการศึกษา
- **เลขประจำตัวประชาชน** - 13 หลัก (ต้องไม่ซ้ำ)
- **หน่วย** - หน่วยงานที่สังกัด
- **เกษียณ** - วันที่เกษียณอายุราชการ (dd/mm/yyyy)
- **จำนวนปี** - จำนวนปีการรับราชการ
- **อายุ** - อายุปัจจุบัน
- **ตท.** - ข้อมูลการฝึกอบรม
- **นรต.** - รุ่นนายร้อยตำรวจ
- **หมายเหตุ/เงื่อนไข** - ข้อมูลเพิ่มเติม

### 3. รูปแบบข้อมูล

#### วันที่
- ใช้รูปแบบ `dd/mm/yyyy`
- ตัวอย่าง: `01/10/2565`, `15/05/2540`
- รองรับทั้ง พ.ศ. และ ค.ศ. (ระบบจะแปลงอัตโนมัติ)

#### ตัวเลข
- อาวุโส, จำนวนปี, อายุ ใช้ตัวเลขเท่านั้น
- ตัวอย่าง: `1`, `23`, `55`

#### เลขบัตรประชาชน
- ต้องเป็นตัวเลข 13 หลัก
- ตัวอย่าง: `1234567890123`
- ต้องไม่ซ้ำกับที่มีอยู่ในระบบ

#### ID
- รหัสประจำตัว ต้องไม่ซ้ำกับที่มีอยู่ในระบบ
- ตัวอย่าง: `P001234`, `POL2024001`

### 4. อัพโหลดไฟล์
1. เลือกไฟล์ Excel ที่เตรียมไว้
2. คลิก "อัพโหลดและตรวจสอบ"
3. รอระบบอ่านและตรวจสอบข้อมูล

### 5. ตรวจสอบข้อมูล
- ระบบจะแสดงตารางข้อมูลทั้งหมด
- แถวที่ถูกต้องจะมีเครื่องหมาย ✓ สีเขียว
- แถวที่ผิดพลาดจะมีเครื่องหมาย ✗ สีแดง พร้อมข้อความอธิบายปัญหา
- สามารถลบแถวที่ไม่ต้องการได้

### 6. นำเข้าข้อมูล
1. ตรวจสอบข้อมูลให้ครบถ้วน
2. คลิก "นำเข้าข้อมูล"
3. รอระบบประมวลผล
4. ดูผลการนำเข้า

## ตัวอย่างข้อมูล

```csv
อาวุโส,ยศ,ชื่อ,สกุล,ID,POSCODE,ตำแหน่ง,เลขตำแหน่ง,ทำหน้าที่,แต่งตั้งครั้งสุดท้าย,ระดับนี้เมื่อ,บรรจุ,วันเกิด,คุณวุฒิ,เลขประจำตัวประชาชน,หน่วย,เกษียณ,จำนวนปี,อายุ,ตท.,นรต.,หมายเหตุ/เงื่อนไข
1,พ.ต.อ.,สมชาย,ใจดี,P001234,POS001,ผู้บังคับการ,001/2560,ผู้บังคับการกองกำลัง,01/10/2565,01/04/2563,15/05/2540,20/03/2520,ปริญญาตรี,1234567890123,กองกำลัง 1,20/03/2580,23,55,,,ดีเยี่ยม
2,ร.ต.อ.,สมหญิง,รักดี,P001235,POS002,หัวหน้างาน,002/2561,หัวหน้างานสอบสวน,15/08/2564,10/06/2562,20/06/2545,15/07/2525,ปริญญาโท,1234567890124,กองสอบสวน,15/07/2585,20,50,,,
```

## ข้อควรระวัง

### 1. ข้อมูลซ้ำ
- ID และเลขบัตรประชาชนต้องไม่ซ้ำกับที่มีในระบบ
- หากพบข้อมูลซ้ำ รายการนั้นจะถูกข้ามและแจ้งเตือน

### 2. รูปแบบไฟล์
- รองรับเฉพาะไฟล์ .xlsx และ .xls
- ต้องมี header row (แถวแรก) ตรงตาม template
- ข้อมูลเริ่มจากแถวที่ 2

### 3. ขนาดไฟล์
- แนะนำไม่เกิน 1,000 รายการต่อครั้ง
- หากมีข้อมูลมาก ควรแบ่งเป็นหลายไฟล์

### 4. การแก้ไขข้อผิดพลาด
- หากพบข้อผิดพลาด สามารถแก้ไขไฟล์ Excel แล้วอัพโหลดใหม่
- หรือลบแถวที่ผิดพลาดออกแล้วนำเข้าเฉพาะแถวที่ถูกต้อง

## การตรวจสอบข้อมูล

ระบบจะตรวจสอบ:
- ✓ ชื่อ, สกุล, ID ต้องไม่เป็นค่าว่าง
- ✓ เลขบัตรประชาชนต้องมี 13 หลัก (ถ้ามี)
- ✓ ID ไม่ซ้ำกับที่มีในระบบ
- ✓ รูปแบบวันที่ถูกต้อง
- ✓ ข้อมูลตัวเลขเป็นตัวเลขจริง

## ผลลัพธ์การนำเข้า

หลังจากนำเข้าเสร็จสิ้น ระบบจะแสดง:
- จำนวนรายการที่สำเร็จ (สีเขียว)
- จำนวนรายการที่ล้มเหลว (สีแดง)
- รายละเอียดข้อผิดพลาด (ถ้ามี)

## การส่งออกข้อมูล

นอกจากนำเข้าแล้ว ยังสามารถส่งออกข้อมูลปัจจุบันได้:
1. ไปที่หน้ารายการบุคลากร
2. กรองข้อมูลตามต้องการ (ยศ, หน่วย, คำค้นหา)
3. คลิกปุ่ม "ส่งออก"
4. ระบบจะดาวน์โหลดไฟล์ Excel พร้อมข้อมูลที่กรองแล้ว

## เคล็ดลับ

1. **ใช้ Template** - เริ่มต้นจาก template เสมอเพื่อให้แน่ใจว่าคอลัมน์ถูกต้อง
2. **ตรวจสอบก่อนอัพโหลด** - ตรวจสอบข้อมูลใน Excel ก่อนอัพโหลด
3. **แบ่งข้อมูล** - ถ้ามีข้อมูลมาก แบ่งเป็นกลุ่มๆ เช่น แยกตามหน่วย
4. **สำรองข้อมูล** - ส่งออกข้อมูลเดิมก่อนนำเข้าข้อมูลใหม่
5. **ทดสอบก่อน** - ลองนำเข้าข้อมูล 2-3 รายการก่อนเพื่อทดสอบ

## การแก้ปัญหา

### ไม่สามารถอ่านไฟล์ได้
- ตรวจสอบว่าเป็นไฟล์ .xlsx หรือ .xls
- ลองเปิดไฟล์ใน Excel ดูว่าเปิดได้หรือไม่
- ลองบันทึกไฟล์ใหม่

### ข้อมูลไม่ถูกต้อง
- ตรวจสอบ header ว่าตรงกับ template หรือไม่
- ตรวจสอบรูปแบบวันที่
- ตรวจสอบว่าไม่มีช่องว่างหรือตัวอักษรพิเศษ

### นำเข้าไม่สำเร็จ
- ตรวจสอบการเชื่อมต่ออินเทอร์เน็ต
- ตรวจสอบสิทธิ์การใช้งาน (ต้องเป็น Admin หรือ HR)
- ลองรีเฟรชหน้าและนำเข้าใหม่

## ติดต่อสอบถาม

หากมีปัญหาหรือข้อสงสัย กรุณาติดต่อผู้ดูแลระบบ
