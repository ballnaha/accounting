# Hydration Mismatch Prevention Guide

## What are Hydration Mismatches?

Hydration mismatches occur when the server-rendered HTML doesn't match what React expects on the client side. This can happen with:

- Dynamic IDs generated by components
- Date/time formatting
- Random values
- Browser-specific content
- Client-only state

## Solutions Implemented

### 1. Stable IDs for Form Elements

**Problem:** Material-UI generates random IDs for form elements during SSR and CSR.

**Solution:** Use `useId()` hook for stable IDs:

```tsx
import { useId } from 'react';

function MyComponent() {
  const fieldId = useId();
  
  return (
    <TextField
      id={fieldId}
      // ... other props
    />
  );
}
```

### 2. Client-Only Wrapper

**Problem:** Some content should only render on the client.

**Solution:** Use the `ClientOnly` component:

```tsx
import ClientOnly from '@/components/common/ClientOnly';

function MyComponent() {
  return (
    <ClientOnly fallback={<div>Loading...</div>}>
      <ComponentThatCausesHydrationIssues />
    </ClientOnly>
  );
}
```

### 3. Common Patterns to Avoid

❌ **Don't do this:**
```tsx
// Random IDs
const id = Math.random().toString();

// Current time
const now = new Date().toLocaleString();

// Browser detection during render
const isBrowser = typeof window !== 'undefined';
```

✅ **Do this instead:**
```tsx
// Stable IDs
const id = useId();

// Static content or use ClientOnly
const now = "Loading..."; // or wrap in ClientOnly

// Use useEffect for browser detection
useEffect(() => {
  setIsBrowser(true);
}, []);
```

## Fixed Components

- ✅ `DeliveryContent.tsx` - Added stable ID for search field
- ✅ `LoginPage.tsx` - Already has stable IDs
- ✅ `ClientOnly` component created for problematic content

## Best Practices

1. Always use stable IDs for form elements
2. Wrap client-only content in `ClientOnly` component
3. Use `useEffect` for browser-specific logic
4. Avoid random values during initial render
5. Be careful with date/time formatting
6. Test SSR behavior during development

## Testing for Hydration Issues

1. Enable React strict mode in development
2. Check browser console for hydration warnings
3. Test with JavaScript disabled to see SSR output
4. Use Next.js development mode which shows detailed error messages